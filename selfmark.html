<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AUDIT REPORT-SELF AUDIT MARKS</title>
    <link rel="stylesheet" href="index.css">
</head>
<body>

    <div class="top">
        <div class="pic">
            <img src= "data:image/png;base64,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" width="100" height="100">
        </div>
        <div class="welcome">
            <p><b>SELF AUDIT MARKS</b></p>
        </div>
    </div>

    <div>
        <button class="homes">
            <a href=admin-home.html style="color:#000000; text-decoration: none;"><b> &#8592; BACK HOME</b></a>
        </button>
    </div>
    <br>
    <br>
    <br>
    <br>
    <center>
    <section style="margin:25px; width:auto; background-image: url('https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTC3KoUHkTrdF_STULH6yMENsz06OTMuOIyQg&usqp=CAU');">
    <br><br><br>
    <div id="square">
    <button id="new" class="square" onclick="addnew()"><b>ADD NEW WEEKLY AUDIT</b></button>
    <button id="edit" class="square" onclick="uploadcsv()"><b>UPDATE WEEKLY AUDIT</b></button>
</div>
    <div id="hola" style="display:none;">
        <h3 style="display:inline;  color:rgb(0, 0, 0);">UPLOAD A CSV FILE TO UPDATE:</h3>
        <input type="file" accept=".csv" id="csvinp" style="display:inline;">
        </div>
    
    <div>
        <button id="addColBtn" class="subbs" style="display:none;" onclick="addNewColumn()">ADD MARKS</button>  
        <br>
    </div>
    
    <div id="csvUploadDiv" style="display: none;">
        <input type="file" id="csvFileInput" accept=".csv">
        <button class="print" onclick="importCSV()">Import CSV</button>
        <br><br>
    </div>
        <table class="rep" id="dataTable" border="1" solid black style="display:none;"><br>
            <br>
            <tr>
                <th>Group</th>
                <th>Check items</th>
                <th>Sl. no.</th>
                <th>Evaluation criteria</th>
                <th colspan="8">Date of Weekly Audit</th>
            </tr>
            <tr>
                <th></th>
                <th></th>
                <th></th>
                <th></th>
                <th><input type="date" id="actiondate0" name="actiondate" required></th>
                    <th><input type="date" id="actiondate1" name="actiondate" required></th>
                    <th><input type="date" id="actiondate1" name="actiondate" required></th>
                    <th><input type="date" id="actiondate1" name="actiondate" required></th>
                    <th><input type="date" id="actiondate1" name="actiondate" required></th>
                    <th><input type="date" id="actiondate1" name="actiondate" required></th>
                    <th><input type="date" id="actiondate1" name="actiondate" required></th>
                    <th><input type="date" id="actiondate1" name="actiondate" required></th>
        
            </tr>
            <tr>

                <td>A</td>
                <td>Lockers</td>
                <td>1</td>
                <td>No irrelevant material kept</td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
            </tr>
            <tr>
                <td>A</td>
                <td>File cabinets</td>
                <td>2</td>
                <td>Proper arrangement</td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
            </tr>
            <tr>
                <td>A</td>
                <td>Almirah</td>
                <td>3</td>
                <td>No loose paper kept in file</td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
            </tr>
            <tr>
                <td>A</td>
                <td>Side racks</td>
                <td>4</td>
                <td>Filling index</td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
            </tr>
            <tr>
                <td>B</td>
                <td>Desks</td>
                <td>5</td>
                <td>No paper to be placed below the glass top</td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
            </tr>
            <tr>
                <td>B</td>
                <td>Desks</td>
                <td>6</td>
                <td>Prefixed location for telephone; desk calendar; tray etc</td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
            </tr>
            <tr>
                <td>B</td>
                <td>Desks</td>
                <td>7</td>
                <td>Proper arrangement of items in table drawers</td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
            </tr>
            <tr>
                <td>B</td>
                <td>Desks</td>
                <td>8</td>
                <td>No irrelevant paper in drawers</td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
            </tr>
            <tr>
                <td>B</td>
                <td>Desks</td>
                <td>9</td>
                <td>Standard paper weight to be used</td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
            </tr>
            <tr>
                <td>C</td>
                <td>Standard of disposal</td>
                <td>10</td>
                <td>Standard to be fixed for disposal documents</td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
            </tr>
            <tr>
                <td>D</td>
                <td>View control</td>
                <td>11</td>
                <td>Irrelevant items; documents can be identified at glace</td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
            </tr>
            <tr>
                <td>D</td>
                <td>View control</td>
                <td>12</td>
                <td>Calendar and all visual displays of the room should be displayed</td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
            </tr>
            <tr>
                <td>D</td>
                <td>View control</td>
                <td>13</td>
                <td>Prefixed location for first-aid box</td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
            </tr>
            <tr>
                <td>D</td>
                <td>View control</td>
                <td>14</td>
                <td>Prefixed location for tools; instruments</td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
            </tr>
            <tr>
                <td>E</td>
                <td>Storage labels</td>
                <td>15</td>
                <td>Labelling of lockers; file cabinets; almirah for immediate identification</td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
            </tr>
            <tr>
                <td>F</td>
                <td>Label of documents</td>
                <td>16</td>
                <td>Everything is clearly identified</td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
            </tr>
            <tr>
                <td>G</td>
                <td>Orderly storage</td>
                <td>17</td>
                <td>Everything is stored in fixed place</td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
            </tr>
            <tr>
                <td>G</td>
                <td>Orderly storage</td>
                <td>18</td>
                <td>Old records are kept with proper identification</td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
            </tr>
            <tr>
                <td>H</td>
                <td>Display areas</td>
                <td>19</td>
                <td>All dividing lines and notice boad are clearly indicated</td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
            </tr>
            <tr>
                <td>I</td>
                <td>Condition of floor</td>
                <td>20</td>
                <td>Condition of floor</td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
            </tr>
            <tr>
                <td>I</td>
                <td>Condition of floor</td>
                <td>21</td>
                <td>Cleaning of room</td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
            </tr>
            <tr>
                <td>J</td>
                <td>Dust and dirty</td>
                <td>22</td>
                <td>Windows; windows sills and shelves are clean</td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
            </tr>
            <tr>
                <td>K</td>
                <td>Waste basket</td>
                <td>23</td>
                <td>Prefixed location for waste box</td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
            </tr>
            <tr>
                <td>K</td>
                <td>Waste basket</td>
                <td>24</td>
                <td>System for getting rid of waste paper</td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
            </tr>
            <tr>
                <td>L</td>
                <td>Cleaning</td>
                <td>25</td>
                <td>Cleaning of name plate and door closer</td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
            </tr>
            <tr>
                <td>L</td>
                <td>Cleaning</td>
                <td>26</td>
                <td>Cleaning of painted walls; doors; windows</td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
            </tr>
            <tr>
                <td>L</td>
                <td>Cleaning</td>
                <td>27</td>
                <td>Cleaning of fans and tube ligts</td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
            </tr>
            <tr>
                <td>M</td>
                <td>Ventilation</td>
                <td>28</td>
                <td>Ventilation system is proper;Air is clean</td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
            </tr>
            <tr>
                <td>N</td>
                <td>Lighting (Electrical)</td>
                <td>29</td>
                <td>Electrical fitting areclearly maintained</td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
            </tr>
            <tr>
                <td>N</td>
                <td>Lighting (Electrical)</td>
                <td>30</td>
                <td>Angle and intensity of illumination are proper</td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
            </tr>
            <tr>
                <td>O</td>
                <td>Furniture</td>
                <td>31</td>
                <td>Conditions of tables and chairs</td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
            </tr>
            <tr>
                <td>P</td>
                <td>Toilets</td>
                <td>32</td>
                <td>No water leakages</td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
            </tr>
            <tr>
                <td>P</td>
                <td>Toilets</td>
                <td>33</td>
                <td>No foul odour</td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
            </tr>
            <tr>
                <td>P</td>
                <td>Toilets</td>
                <td>34</td>
                <td>Ventilation system is poor</td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
            </tr>
            <tr>
                <td>P</td>
                <td>Toilets</td>
                <td>35</td>
                <td>Clean</td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
            </tr>
            <tr>
                <td>Q</td>
                <td>Tea room</td>
                <td>36</td>
                <td>No foul odour</td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
            </tr>
            <tr>
                <td>Q</td>
                <td>Tea room</td>
                <td>37</td>
                <td>General cleaning and neatness</td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
            </tr>
            <tr>
                <td>R</td>
                <td>Participation</td>
                <td>38</td>
                <td>Participation of all employees in 5 S activites</td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
            </tr>
            <tr>
                <td>S</td>
                <td>Retrievability</td>
                <td>39</td>
                <td>Retrievability of all items/files in one minute</td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
            </tr>
            <tr>
                <td>T</td>
                <td>Rules</td>
                <td>40</td>
                <td>All rules and regulations are strictly observed</td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
            </tr>
        </table>
<div id="three" style="display:none;">
        <button type="button" class="three" onclick="save()"><b>SAVE</b></button>
        <button type="button" class="three" onclick="getdatee()"><b>EXPORT</b></button>
    </div>
    <div id="date" style="display:none;">
    <br> <h3 style="color:black;display:inline;">Enter the first day of audit: </h3>
    <input type="date" style="display:inline;" id="dod">
    </div>
    <br>
    <br>
    </section>
</center>

    <script src="script.js"></script>
    <script>

        function addNewColumn() {
            document.getElementById('csvUploadDiv').style.display = 'block';

        }

        function importCSV() {
            const fileInput = document.getElementById('csvFileInput');
            const file = fileInput.files[0];

            if (file) {
                const reader = new FileReader();

                reader.onload = function (e) {
                    const csv = e.target.result;
                    processData(csv);
                };

                reader.readAsText(file);
            }
            document.getElementById('csvUploadDiv').style.display = 'none';
        }

        function processData(csv) {
            const lines = csv.split('\n');
            const data = lines.map(line => line.split(','));

            const targetColumn = findEmptyColumn();

            const dataTable = document.getElementById('dataTable');
            const rows = dataTable.querySelectorAll('tr');

            for (let i = 2; i < rows.length; i++) {
                const targetCell = rows[i].cells[targetColumn - 1];
                targetCell.textContent = data[i - 1][1];
                
            }
        }

        function findEmptyColumn() {
            const dataTable = document.getElementById('dataTable');
            const rows = dataTable.querySelectorAll('tr');

            for (let col = 5; col <= 12; col++) {
                let isEmptyColumn = true;
                for (let row = 2; row < rows.length; row++) {
                    const cell = rows[row].cells[col - 1];
                    if (cell && cell.textContent.trim() !== '') {
                        isEmptyColumn = false;
                    } 
                    break;
                }
                if (isEmptyColumn) {
                    return col;
                }
            }
        }
        
        function save() {
            const csvContent = [];
            var today = new Date();
            var dd = String(today.getDate());
            var mm = String(today.getMonth() + 1); 
            var yyyy = String(today.getFullYear());
            today = dd + '-' + mm + '-' + yyyy;
            csvContent.push(['Group', 'Check Items', 'Sl.no.', 'Evaluation criteria', 'Date of weekly audit'].join(','));
            for (let i = 1; i < table.rows.length; i++) {
                const row = table.rows[i];
                const rowData = [];
                for (let j = 0; j < row.cells.length; j++) {
                    const cell = row.cells[j];
                    if (cell.querySelector('input[type=date]')) {
                        rowData.push(cell.querySelector('input[type=date]').value);
                    } else {
                        rowData.push(cell.innerText);
                    }
                }
                csvContent.push(rowData.join(','));
            }
            const csvString = csvContent.join('\n');
            const blob = new Blob([csvString], { type: 'text/csv;charset=utf-8;' });
            const link = document.createElement('a');
            if (link.download !== undefined) {
                const url = URL.createObjectURL(blob);
                link.setAttribute('href', url);
                link.setAttribute('download', "weekly-audit-("+today+").csv");
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
            } else {
                alert('Your browser does not support the download attribute.');
            }
        }

        function getdatee(){
        document.getElementById("date").style.display="block";
        var d=new Date(document.getElementById('dod').value);

            const curr=d.toLocaleString('default',{month: 'long'});
            var n_mon=d.getMonth()+1;
            var n_year=d.getFullYear();
            if (n_mon >11){
                n_mon=0;
                n_year+=1;
            }
            const n_d=new Date(n_year,n_mon,1);
            const next=n_d.toLocaleString('default',{month: 'long'});
        }
        
        dod.addEventListener('change',() =>{
            convertToPDF();
        });

        function convertToPDF(){
            var csv_data = [];
            var rows = document.getElementsByTagName('tr');
            for (var i = 0; i < rows.length; i++) {
                var cols = rows[i].querySelectorAll('td,th input');
                var csvrow = [];
                for (var j = 0; j < cols.length; j++) {
                    if (cols[j].tagName === "INPUT") {
                        csvrow.push(cols[j].value);
                    } else {
                        csvrow.push(cols[j].innerHTML);
                    }
                }
                csv_data.push(csvrow.join(","));
            }
            var d=new Date(document.getElementById('dod').value);
            console.log(d);
            const curr=d.toLocaleString('default',{month: 'long'});
            var n_mon=d.getMonth()+1;
            var n_year=d.getFullYear();
            if (n_mon >11){
                n_mon=0;
                n_year+=1;
            }
            const n_d=new Date(n_year,n_mon,1);
            const next=n_d.toLocaleString('default',{month: 'long'});

            var csvContent = csv_data.join('\n');
            var printWindow = window.open('', '_blank');
            printWindow.document.open();
            printWindow.document.write('<html><head><title>Weekly Audit</title></head><body><center><h4>SELF AUDIT MARKS -('+curr+'-'+next+' ['+n_year+'])</h4><table border="1px" solid black style="font-size:11.75px; border-collapse:collapse; height:80px; width:100%; text-align:center;">');
            var rowsArray = csv_data.map(row => row.split(','));
            printWindow.document.write('<tr><th>GROUP</th><th>CHECK ITEMS</th><th>SL. NO.</th><th>EVALUATION CRITERIA</th><th colspan="8">DATE OF WEEKLY AUDIT</th></tr>')
            for (var i = 1; i < rowsArray.length; i++) {
                printWindow.document.write('<tr>');
                    for (var j = 0; j < rowsArray[i].length; j++) {
                        printWindow.document.write('<td>' + rowsArray[i][j] + '</td>');
                    }
                    printWindow.document.write('</tr>');
                }
                printWindow.document.write('</table></center></body></html>');
                printWindow.document.close();
                printWindow.print();
                printWindow.close();
            }

            function uploadcsv(){
                var tip=document.getElementById("hola");
                tip.style.display="block";
                document.getElementById('square').style.display="none";
            }

            var data=[];
            var table=document.getElementById('dataTable');

            csvinp.addEventListener('change',() =>{
                document.getElementById('addColBtn').style.display="block";
                document.getElementById("three").style.display="block";
                document.getElementById('dataTable').style.display="block";
                var tip=document.getElementById("hola");
                tip.style.display="none";
                const file=csvinp.files[0];
                const reader=new FileReader();
                reader.readAsText(file);
                reader.onload=()=>{
                    const rows=reader.result.split('\n');
                    for (const row of rows){
                        const values = row.split(',');
                        data.push(values);
                    }
                    displayTable();
                };
            });

            function displayTable() {
                table.innerHTML = "";
                const headerRow = document.createElement('tr');
                for (const header of ['Group', 'Check Items', 'Sl.no.', 'Evaluation criteria', 'Date of weekly audit']) {
                    const headerCell = document.createElement('th');
                    if (header === "Date of weekly audit") {
                        headerCell.setAttribute("colspan", "8");
                    } 
                    headerCell.innerText = header;
                    headerRow.appendChild(headerCell);
                }
                table.appendChild(headerRow);
                for (let i = 1; i < data.length; i++) {
                    const row = document.createElement('tr');
                    let foundDateInput = false;
                    for (let j = 0; j < data[3].length; j++) {
                        const cell = document.createElement('td');
                        if (data[i][j]) {
                            foundDateInput = true;
                            cell.innerText = data[i][j];
                        } else {
                            if (i === 1 && foundDateInput) {
                                cell.innerHTML = "<input type='date'>";
                            } 
                        }
                        row.appendChild(cell);
                    }
                    table.appendChild(row);
                }
            }
            
            function addnew(){
                document.getElementById('square').style.display="none";
                document.getElementById('dataTable').style.display="block";
                document.getElementById('addColBtn').style.display="block";
                document.getElementById('three').style.display="block";
            }
        
    </script>
</body>
</html>
